<html>
  <body>
    <div>
      <p>You are logged in!</p>
      <p>If this window stays open, check the console for errors.</p>
    </div>

    <script>
      (function() {
        if (!window.opener) {
          return;
        }
        const params = new URLSearchParams(window.location.search);
        const accessToken = params.get('access_token')
        const customerOrigin = params.get('customer_origin');

        localStorage.setItem('access_token', accessToken);
        console.log('posting to', customerOrigin, accessToken)
        window.opener.postMessage({ accessToken }, customerOrigin);
        window.close();
      })();
    </script>
  </body>
</html>
